{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-auto px-0 min-vh-100 bg-dark">
            <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-4 text-white">
                <span class="fs-5 pb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                    <i class="bi bi-gear-fill me-2"></i>
                    <span class="d-none d-sm-inline">Panel Admina</span>
                </span>
                <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start w-100" id="adminMenu">
                    <li class="nav-item w-100">
                        <a href="/admin/dashboard" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-speedometer2"></i>
                            <span class="ms-2 d-none d-sm-inline">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/users" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-people"></i>
                            <span class="ms-2 d-none d-sm-inline">Użytkownicy</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/backups" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-cloud-arrow-up"></i>
                            <span class="ms-2 d-none d-sm-inline">Backup/Restore</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/logs" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-journal-text"></i>
                            <span class="ms-2 d-none d-sm-inline">Logi systemowe</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/settings" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-sliders"></i>
                            <span class="ms-2 d-none d-sm-inline">Ustawienia</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/jira" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-box"></i>
                            <span class="ms-2 d-none d-sm-inline">Konfiguracja Jira</span>
                        </a>
                    </li>
                    <li class="nav-item w-100">
                        <a href="/admin/custom-roles" class="nav-link text-white px-0 align-middle">
                            <i class="bi bi-shield-lock"></i>
                            <span class="ms-2 d-none d-sm-inline">Role niestandardowe</span>
                        </a>
                    </li>
                </ul>
                <hr class="w-100">
                <div class="dropdown pb-4">
                    <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-person-circle fs-4"></i>
                        <span class="d-none d-sm-inline mx-2">{{ user.user_name }}</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
                        <li><a class="dropdown-item" href="/settings/profile">Profil</a></li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="#" onclick="toggleTheme(); return false;">
                                <i class="bi bi-moon-stars me-2"></i>
                                <span>Tryb ciemny</span>
                            </a>
                        </li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/logout">Wyloguj</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="col ps-md-4 pt-4">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/admin">Panel Admina</a></li>
                    <li class="breadcrumb-item active">{% block breadcrumb %}{% endblock %}</li>
                </ol>
            </nav>

            <!-- Page Content -->
            {% block admin_content %}{% endblock %}
        </div>
    </div>
</div>

<!-- Common Loader -->
<div id="loader" class="position-fixed top-0 start-0 w-100 h-100 bg-white d-flex align-items-center justify-content-center" style="z-index: 9999; display: none;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Ładowanie...</span>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
<style>
/* Common Admin Styles */
:root {
    --sidebar-width: 250px;
    --sidebar-collapsed-width: 60px;
    --header-height: 60px;
    --card-border-radius: 8px;
    --transition-speed: 0.2s;
    
    /* Light theme */
    --bg-main: #ffffff;
    --bg-sidebar: #212529;
    --bg-card: #ffffff;
    --text-main: #212529;
    --text-muted: #6c757d;
    --border-color: #dee2e6;
}

[data-bs-theme="dark"] {
    --bg-main: #212529;
    --bg-sidebar: #1a1d20;
    --bg-card: #2c3034;
    --text-main: #f8f9fa;
    --text-muted: #adb5bd;
    --border-color: #495057;
}

body {
    background-color: var(--bg-main);
    color: var(--text-main);
}

@keyframes slideIn {
    from {
        transform: translateX(-100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.bg-dark {
    animation: slideIn 0.3s ease-out;
    width: var(--sidebar-width);
    transition: width var(--transition-speed) ease-in-out;
    background-color: var(--bg-sidebar) !important;
}

.nav-link {
    border-radius: 8px;
    margin-bottom: 5px;
    transition: all 0.2s ease-in-out;
}

.nav-link:hover {
    background-color: rgba(255,255,255,0.1);
    transform: translateX(5px);
}

.nav-link.active {
    background: linear-gradient(45deg, var(--bs-primary), #2d8bff) !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card {
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    border: none;
    border-radius: var(--card-border-radius);
    background-color: var(--bg-card);
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.card-header {
    background: var(--bg-card);
    border-bottom: none;
    border-radius: var(--card-border-radius) var(--card-border-radius) 0 0 !important;
}

.table {
    margin-bottom: 0;
}

.table th {
    font-weight: 500;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
}

.btn-action {
    width: 32px;
    height: 32px;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.5rem;
    border-radius: 8px;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: #555;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .col-auto {
        width: var(--sidebar-collapsed-width);
    }
    
    .card-body {
        padding: 1rem;
    }
    
    .table th {
        font-size: 0.75rem;
    }
}

/* Page-specific styles */
{% block admin_css %}{% endblock %}

/* Dodaj style dla tabel */
.table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

.table th {
    white-space: nowrap;
    background-color: var(--bs-gray-100);
}

.table td {
    vertical-align: middle;
}

/* Style dla przycisków akcji */
.btn-action {
    padding: 0.25rem 0.5rem;
    line-height: 1;
}

/* Style dla modali */
.modal-header {
    background-color: var(--bs-gray-100);
    border-bottom: 1px solid var(--bs-gray-200);
}

.modal-footer {
    background-color: var(--bs-gray-50);
    border-top: 1px solid var(--bs-gray-200);
}
</style>
{% endblock %}

{% block extra_js %}
<!-- Common Admin Scripts -->
<script>
function toggleTheme() {
    const html = document.documentElement;
    const currentTheme = html.getAttribute('data-bs-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    html.setAttribute('data-bs-theme', newTheme);
    localStorage.setItem('theme', newTheme);
}

// Ustaw zapisany motyw przy ładowaniu strony
document.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-bs-theme', savedTheme);
});

function showLoader() {
    document.getElementById('loader').style.display = 'flex';
}

function hideLoader() {
    document.getElementById('loader').style.display = 'none';
}

// Highlight active menu item
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;
    const menuItems = document.querySelectorAll('#adminMenu .nav-link');
    menuItems.forEach(item => {
        if (item.getAttribute('href') === currentPath) {
            item.classList.add('active');
            item.classList.remove('text-white');
        }
    });
});
</script>

<!-- Page-specific scripts -->
{% block admin_js %}{% endblock %}
{% endblock %} 